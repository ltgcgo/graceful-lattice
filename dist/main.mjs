"use strict";let a="<!DOCTYPE html><head><title>Internal Error</title></head><body><div><p>Graceful Lattice has encountered an error. Detailed information below.</p><pre>${errorTrace}</pre></div></body>\n";let d=async function(e,r){},s=d;let i=JSON.parse('{"status":204,"headers":{"Content-Type":"text/html"}}'),h=JSON.parse('{"status":500,"headers":{"Content-Type":"text/html"}}'),n,l=Deno.env.get("LISTEN_ADDR"),u=parseInt(Deno.env.get("LISTEN_PORT")),D=parseInt(Deno.env.get("GRACE_JAIL"));n=JSON.parse(`{"hostname":"0.0.0.0","port":${u||8e3}}`);l&&(n.hostname=l);n.onListen=function({hostname:e,port:r}){console.info(`Graceful lattice is now listening on http://${e}:${r}/`)};n.handler=async function(e,r){let o=r.remoteAddr;console.debug(`> ${e.method.toUpperCase().padStart(7," ")} --- ${o.hostname}:${o.port} ${e.url}`);let t;try{t=await s(e,r),t||(t=new Response(a.replace("${errorTrace}","The handler did not return any response."),i))}catch(p){t=new Response(a.replace("${errorTrace}",p.stack.replaceAll(Deno.cwd(),"@app")),h)}return console.debug(`< ${e.method.toUpperCase().padStart(7," ")} ${t.status} ${o.hostname}:${o.port} ${e.url}`),t};let g=Deno.serve(n);
